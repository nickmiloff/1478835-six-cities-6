(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{73:function(e,a,t){"use strict";t.d(a,"c",(function(){return i})),t.d(a,"d",(function(){return n})),t.d(a,"b",(function(){return c})),t.d(a,"a",(function(){return l}));var r=t(11),s=t.n(r);const i={images:s.a.arrayOf(s.a.string.isRequired),isPremium:s.a.bool.isRequired,title:s.a.string.isRequired,isFavorite:s.a.bool.isRequired,rating:s.a.number.isRequired,type:s.a.string.isRequired,bedrooms:s.a.number.isRequired,maxAdults:s.a.number.isRequired,price:s.a.number.isRequired,goods:s.a.arrayOf(s.a.string.isRequired),host:s.a.shape({avatarUrl:s.a.string.isRequired,id:s.a.number.isRequired,isPro:s.a.bool.isRequired,name:s.a.string.isRequired}),description:s.a.string.isRequired},n={comment:s.a.string.isRequired,date:s.a.string.isRequired,id:s.a.number.isRequired,rating:s.a.number.isRequired,user:s.a.shape({avatarUrl:s.a.string.isRequired,id:s.a.number.isRequired,isPro:s.a.bool.isRequired,name:s.a.string.isRequired})},c={id:s.a.number.isRequired,isFavorite:s.a.bool.isRequired,isPremium:s.a.bool.isRequired,previewImage:s.a.string.isRequired,price:s.a.number.isRequired,rating:s.a.number.isRequired,title:s.a.string.isRequired,type:s.a.string.isRequired,city:s.a.shape({name:s.a.string.isRequired})},l={avatarUrl:s.a.string.isRequired,email:s.a.string.isRequired,id:s.a.number.isRequired,isPro:s.a.bool.isRequired,name:s.a.string.isRequired}},74:function(e,a,t){"use strict";var r=t(0),s=t.n(r),i=t(18),n=t(12),c=t(11),l=t.n(c),o=t(19),m=t(73),p=t(31),d=t(30),u=t(29);const _={border:"none",backgroundColor:"transparent"},v=({isAuth:e,user:a,onLogout:t})=>s.a.createElement("header",{className:"header"},s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"header__wrapper"},s.a.createElement("div",{className:"header__left"},s.a.createElement(o.b,{className:"header__logo-link header__logo-link--active",to:"/"},s.a.createElement("img",{className:"header__logo",src:"img/logo.svg",alt:"6 cities logo",width:"81",height:"41"}))),s.a.createElement("nav",{className:"header__nav"},s.a.createElement("ul",{className:"header__nav-list"},s.a.createElement("li",{className:"header__nav-item user"},s.a.createElement(o.b,{className:"header__nav-link header__nav-link--profile",to:e?"/favorites":"/login"},s.a.createElement("div",{className:"header__avatar-wrapper user__avatar-wrapper",style:e&&{backgroundImage:a.avatarUrl}||{}}),s.a.createElement("span",{className:e?"header__user-name user__name":"header__login"},e&&a.email||"Sign in"))),e&&s.a.createElement("li",{className:"header__nav-item user"},s.a.createElement("button",{className:"header__nav-link header__nav-link--profile",style:_,onClick:()=>t(),"data-testid":"logout"},s.a.createElement("span",{className:"header__login"},"Logout"))))))));v.propTypes={isAuth:l.a.bool.isRequired,user:l.a.shape(m.a),onLogout:l.a.func.isRequired};const g={onLogout:d.c};a.a=Object(n.d)(Object(i.b)(e=>({user:Object(p.b)(e)}),g),u.a)(v)},75:function(e,a,t){"use strict";var r=t(0),s=t.n(r),i=t(11),n=t.n(i),c=t(32),l=t(10);a.a=e=>{const a=a=>s.a.createElement(s.a.Fragment,null,a.isLoaded===l.a.LOAD&&s.a.createElement(c.a,null),s.a.createElement(e,a));return a.propTypes={isLoaded:n.a.oneOf([...Object.values(l.a)]).isRequired},a}},76:function(e,a,t){"use strict";var r=t(0),s=t.n(r),i=t(11),n=t.n(i),c=t(3),l=t(19),o=t(29),m=t(73);const p={main:{articleClass:"cities__place-card ",image:{class:"cities",width:260,height:200},infoClass:""},favorites:{articleClass:"favorites__card ",image:{class:"favorites",width:150,height:110},infoClass:"favorites__card-info "},offer:{articleClass:"near-places__card ",image:{class:"near-places",width:260,height:200},infoClass:""}},d=({isPremium:e,previewImage:a,price:t,isFavorite:r,rating:i,title:n,id:o,type:m,cardType:d,onChnageActiveCardId:u,onFavoriteClick:_,isAuth:v})=>{const g=p[d],h=Object(c.g)();return s.a.createElement("article",{className:g.articleClass+"place-card",onMouseEnter:()=>{u(o)},onMouseLeave:()=>{u(null)}},e&&s.a.createElement("div",{className:"place-card__mark"},s.a.createElement("span",null,"Premium"))||"",s.a.createElement("div",{className:g.image.class+"__image-wrapper place-card__image-wrapper"},s.a.createElement(l.b,{to:"/offer/"+o},s.a.createElement("img",{className:"place-card__image",src:a,width:g.image.width,height:g.image.height,alt:"Place image"}))),s.a.createElement("div",{className:g.infoClass+"place-card__info"},s.a.createElement("div",{className:"place-card__price-wrapper"},s.a.createElement("div",{className:"place-card__price"},s.a.createElement("b",{className:"place-card__price-value"},"€",t),s.a.createElement("span",{className:"place-card__price-text"},"/ night")),s.a.createElement("button",{className:"place-card__bookmark-button button"+(r?" place-card__bookmark-button--active":""),type:"button",onClick:()=>v?_(o,!r):h.push("/login"),"data-testid":"to-bookmarks-button"},s.a.createElement("svg",{className:"place-card__bookmark-icon",width:"18",height:"19"},s.a.createElement("use",{xlinkHref:"#icon-bookmark"})),s.a.createElement("span",{className:"visually-hidden"},"To bookmarks"))),s.a.createElement("div",{className:"place-card__rating rating"},s.a.createElement("div",{className:"place-card__stars rating__stars"},s.a.createElement("span",{style:{width:20*i+"%"}}),s.a.createElement("span",{className:"visually-hidden"},"Rating"))),s.a.createElement("h2",{className:"place-card__name"},s.a.createElement(l.b,{to:"/offer/"+o},n)),s.a.createElement("p",{className:"place-card__type"},m)))};d.propTypes={...m.b,onChnageActiveCardId:n.a.func.isRequired,onFavoriteClick:n.a.func.isRequired,isAuth:n.a.bool.isRequired};var u=Object(o.a)(d);function _(){return(_=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}const v={main:"cities__places-list places__list tabs__content",favorites:"favorites__places",offer:"near-places__list places__list"},g=({cards:e,cardType:a,onChnageActiveCardId:t=(()=>{}),onFavoriteClick:r})=>{const i=s.a.useCallback(e=>t(e),[]);return s.a.createElement("div",{className:v[a]},e.map(e=>s.a.createElement(u,_({cardType:a,key:e.id,onChnageActiveCardId:i,onFavoriteClick:r},e))))};g.propTypes={cards:n.a.array.isRequired,cardType:n.a.string.isRequired,onChnageActiveCardId:n.a.func,onFavoriteClick:n.a.func.isRequired};a.a=s.a.memo(g)},77:function(e,a,t){"use strict";var r=t(0),s=t.n(r),i=t(11),n=t.n(i),c=t(78),l=t.n(c),o=(t(79),t(73));const m={main:"cities__map",offer:"property__map"},p={Amsterdam:[52.3833,4.9044],Paris:[48.8589,2.3469],Cologne:[50.9293,6.9595],Brussels:[50.8552,4.3453],Hamburg:[53.5503,10.0006],Dusseldorf:[51.2287,6.7743]},d={width:"100%",height:"100%"},u={zoom:12,zoomControl:!1,marker:!0},_=l.a.icon({iconUrl:"img/pin.svg",iconSize:[30,30]}),v=l.a.icon({iconUrl:"img/pin-active.svg",iconSize:[30,30]}),g=(e,a,t)=>{a.forEach(a=>{l.a.marker({lat:a.location.latitude,lon:a.location.longitude},{icon:a.id===t?v:_}).addTo(e)})},h=e=>{e.eachLayer((function(e){e instanceof l.a.Marker&&e.remove()}))},b=({activeLocation:e,cards:a,activeCardId:t,type:i})=>{const n=Object(r.useRef)(),c=p[e]||e,o=m[i];return Object(r.useEffect)(()=>(n.current=l.a.map("map",{center:c,...u}),l.a.tileLayer("https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>'}).addTo(n.current),g(n.current,a,t),()=>{n.current.remove()}),[]),Object(r.useEffect)(()=>{n.current.flyTo(new l.a.LatLng(...c),u.zoom),h(n.current),g(n.current,a,t)},[JSON.stringify(a)]),Object(r.useEffect)(()=>{h(n.current),g(n.current,a,t)},[t]),s.a.createElement("section",{className:o+" map"},s.a.createElement("div",{id:"map",style:d,ref:n}))};b.propTypes={activeLocation:n.a.oneOfType([n.a.array,n.a.string]).isRequired,cards:n.a.arrayOf(n.a.shape(o.b)),activeCardId:n.a.number,type:n.a.string.isRequired},a.a=s.a.memo(b)},89:function(e,a,t){"use strict";t.r(a);var r=t(0),s=t.n(r),i=t(12),n=t(18),c=t(3),l=t(11),o=t.n(l),m=t(73),p=t(74);const d=({comment:e,date:a,rating:t,user:r})=>s.a.createElement("li",{className:"reviews__item"},s.a.createElement("div",{className:"reviews__user user"},s.a.createElement("div",{className:"reviews__avatar-wrapper user__avatar-wrapper"},s.a.createElement("img",{className:"reviews__avatar user__avatar",src:r.avatarUrl,width:"54",height:"54",alt:"Reviews avatar"})),s.a.createElement("span",{className:"reviews__user-name"},r.name)),s.a.createElement("div",{className:"reviews__info"},s.a.createElement("div",{className:"reviews__rating rating"},s.a.createElement("div",{className:"reviews__stars rating__stars"},s.a.createElement("span",{style:{width:20*t+"%"}}),s.a.createElement("span",{className:"visually-hidden"},"Rating"))),s.a.createElement("p",{className:"reviews__text"},e),s.a.createElement("time",{className:"reviews__time",dateTime:a},new Date(a).toLocaleDateString("en-EU",{month:"long",year:"numeric"}))));d.propTypes=m.d;var u=d;function _(){return(_=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}const v=({reviews:e})=>s.a.createElement("ul",{className:"reviews__list"},e.map(e=>s.a.createElement(u,_({key:e.id},e))));v.propTypes={reviews:o.a.array.isRequired};var g=v;const h=e=>e.offer.offer,b=e=>e.offer.nearby.slice(0,3),E=e=>e.offer.reviews.slice(0,10),f=e=>e.offer.loaded,y=e=>e.offer.reviewLoaded;var N=t(14),w=t(7),R=t(10),k=t(15);const q=50,O=300,C=({onSubmit:e,isLoaded:a})=>{const[t,i]=Object(r.useState)(null),[n,l]=Object(r.useState)(""),{id:o}=Object(c.h)();return Object(r.useEffect)(()=>{a===R.a.LOADED&&(i(null),l(""))},[a]),s.a.createElement("form",{className:"reviews__form form",action:"#",method:"post",onSubmit:a=>{a.preventDefault(),e(o,n,t)},"data-testid":"form"},s.a.createElement("label",{className:"reviews__label form__label",htmlFor:"review"},"Your review"),s.a.createElement("div",{className:"reviews__rating-form form__rating"},Array(5).fill("").map((e,r)=>s.a.createElement(s.a.Fragment,{key:"rating-star-"+r},s.a.createElement("input",{className:"form__rating-input visually-hidden",name:"rating",value:5-r,id:5-r+"-stars",type:"radio",onChange:()=>{i(()=>5-r)},checked:t===5-r,disabled:a===R.a.LOAD}),s.a.createElement("label",{htmlFor:5-r+"-stars",className:"reviews__rating-label form__rating-label",title:"perfect"},s.a.createElement("svg",{className:"form__star-image",width:"37",height:"33"},s.a.createElement("use",{xlinkHref:"#icon-star"})))))),s.a.createElement("textarea",{className:"reviews__textarea form__textarea",id:"review",name:"review",placeholder:"Tell how was your stay, what you like and what can be improved",value:n,onChange:e=>{l(e.target.value)},maxLength:O,disabled:a===R.a.LOAD,"data-testid":"review"}),s.a.createElement("div",{className:"reviews__button-wrapper"},s.a.createElement("p",{className:"reviews__help"},"To submit review please make sure to set ",s.a.createElement("span",{className:"reviews__star"},"rating")," and describe your stay with at least ",s.a.createElement("b",{className:"reviews__text-amount"},"50 characters"),"."),s.a.createElement("button",{className:"reviews__submit form__submit button",type:"submit",disabled:null===t||n.length<q||a===R.a.LOAD},"Submit")),a===R.a.ERROR&&s.a.createElement("div",{className:"form__error"},s.a.createElement("span",null,"Oups... Review sending error!")))};C.propTypes={isLoaded:o.a.oneOf([...Object.values(R.a)]).isRequired,onSubmit:o.a.func.isRequired};const j={onSubmit:(e,a,t)=>(r,s,i)=>(r(N.e(R.a.LOAD)),i.post("comments/"+e,{comment:a,rating:t}).then(({data:e})=>{r(N.f(e.map(k.b))),r(N.e(R.a.LOADED))}).catch(()=>{r(N.e(R.a.ERROR))}).finally(()=>{setTimeout(()=>r(N.e(R.a.PENDING)),5e3)}))};var L=Object(n.b)(e=>({isLoaded:y(e)}),j)(C);const A=({reviews:e,isAuth:a})=>s.a.createElement("section",{className:"property__reviews reviews"},s.a.createElement("h2",{className:"reviews__title"},"Reviews · ",s.a.createElement("span",{className:"reviews__amount"},e.length)),s.a.createElement(g,{reviews:e}),a&&s.a.createElement(L,null)||"");A.propTypes={reviews:o.a.array.isRequired,isAuth:o.a.bool.isRequired};var T=s.a.memo(A),F=t(77),P=t(29);const D=({offer:e,reviews:a,mapPlaces:t,onFavoriteClick:r,isAuth:i})=>{const{images:n,isPremium:l,title:o,isFavorite:m,rating:p,type:d,bedrooms:u,maxAdults:_,price:v,goods:g,host:h,description:b,id:E,location:f}=e,y=Object(c.g)();return s.a.createElement("section",{className:"property"},s.a.createElement("div",{className:"property__gallery-container container"},s.a.createElement("div",{className:"property__gallery"},n.slice(0,6).map((e,a)=>s.a.createElement("div",{className:"property__image-wrapper",key:"property-image-"+a},s.a.createElement("img",{className:"property__image",src:e,alt:"Photo studio"}))))),s.a.createElement("div",{className:"property__container container"},s.a.createElement("div",{className:"property__wrapper"},l&&s.a.createElement("div",{className:"property__mark"},s.a.createElement("span",null,"Premium"))||"",s.a.createElement("div",{className:"property__name-wrapper"},s.a.createElement("h1",{className:"property__name"},o),s.a.createElement("button",{className:"property__bookmark-button button"+(m?" property__bookmark-button--active":""),type:"button",onClick:()=>i?r(E,!m):y.push("/login"),"data-testid":"to-bookmarks"},s.a.createElement("svg",{className:"property__bookmark-icon",width:"31",height:"33"},s.a.createElement("use",{xlinkHref:"#icon-bookmark"})),s.a.createElement("span",{className:"visually-hidden"},"To bookmarks"))),s.a.createElement("div",{className:"property__rating rating"},s.a.createElement("div",{className:"property__stars rating__stars"},s.a.createElement("span",{style:{width:20*p+"%"}}),s.a.createElement("span",{className:"visually-hidden"},"Rating")),s.a.createElement("span",{className:"property__rating-value rating__value"},p)),s.a.createElement("ul",{className:"property__features"},s.a.createElement("li",{className:"property__feature property__feature--entire"},d),s.a.createElement("li",{className:"property__feature property__feature--bedrooms"},u," Bedrooms"),s.a.createElement("li",{className:"property__feature property__feature--adults"},"Max ",_," adults")),s.a.createElement("div",{className:"property__price"},s.a.createElement("b",{className:"property__price-value"},"€",v),s.a.createElement("span",{className:"property__price-text"}," night")),s.a.createElement("div",{className:"property__inside"},s.a.createElement("h2",{className:"property__inside-title"},"What's inside"),s.a.createElement("ul",{className:"property__inside-list"},g.map((e,a)=>s.a.createElement("li",{className:"property__inside-item",key:"property-good-"+a},e)))),s.a.createElement("div",{className:"property__host"},s.a.createElement("h2",{className:"property__host-title"},"Meet the host"),s.a.createElement("div",{className:"property__host-user user"},s.a.createElement("div",{className:"property__avatar-wrapper user__avatar-wrapper"+(h.isPro?" property__avatar-wrapper--pro":"")},s.a.createElement("img",{className:"property__avatar user__avatar",src:h.avatarUrl,width:"74",height:"74",alt:"Host avatar"})),s.a.createElement("span",{className:"property__user-name"},h.name)),s.a.createElement("div",{className:"property__description"},s.a.createElement("p",{className:"property__text"},b))),s.a.createElement(T,{reviews:a,isAuth:i}))),s.a.createElement(F.a,{cards:[...t,e],activeLocation:[f.latitude,f.longitude],activeCardId:E,type:"offer"}))};Object(P.a)(D);D.propTypes={offer:o.a.shape(m.c).isRequired,reviews:o.a.array.isRequired,mapPlaces:o.a.array.isRequired,isAuth:o.a.bool.isRequired,onFavoriteClick:o.a.func.isRequired};const x={onFavoriteClick:(e,a)=>(t,r,s)=>s.post(`favorite/${e}/${Number(a)}`).then(({data:e})=>{t(N.d(Object(k.c)(e))),t(w.a(Object(k.c)(e)))}).catch(()=>{t(N.b(R.a.ERROR))})};var S=Object(i.d)(Object(n.b)(null,x),P.a)(D),I=t(76);const M=({places:e,onFavoriteClick:a})=>s.a.createElement("section",{className:"near-places places"},s.a.createElement("h2",{className:"near-places__title"},"Other places in the neighbourhood"),s.a.createElement(I.a,{cards:e,cardType:"offer",onFavoriteClick:a}));M.propTypes={places:o.a.array.isRequired,onFavoriteClick:o.a.func.isRequired};const U={onFavoriteClick:(e,a)=>(t,r,s)=>s.post(`favorite/${e}/${Number(a)}`).then(({data:e})=>{t(N.a(Object(k.c)(e))),t(w.a(Object(k.c)(e)))}).catch(()=>{t(N.b(R.a.ERROR))})};var z=Object(n.b)(null,U)(M),H=t(75);const $=({offer:e,nearby:a,reviews:t,onComponentMount:i})=>{const n=Object(c.h)();return Object(r.useEffect)(()=>{i(n.id)},[n.id]),s.a.createElement("div",{className:"page"},s.a.createElement(p.a,null),s.a.createElement("main",{className:"page__main page__main--property"},s.a.createElement(S,{offer:e,reviews:t,mapPlaces:a}),s.a.createElement("div",{className:"container"},s.a.createElement(z,{places:a}))))};$.propTypes={offer:o.a.shape(m.c).isRequired,nearby:o.a.array.isRequired,reviews:o.a.array.isRequired,onComponentMount:o.a.func.isRequired};const J={onComponentMount:e=>(a,t,r)=>(a(N.b(R.a.LOAD)),Promise.all([r.get("hotels/"+e),r.get(`hotels/${e}/nearby`),r.get("comments/"+e)]).then(([e,t,r])=>{a(N.d(Object(k.c)(e.data))),a(N.c(t.data.map(k.c))),a(N.f(r.data.map(k.b))),a(N.b(R.a.LOADED))}).catch(()=>{a(N.b(R.a.ERROR))}))};a.default=Object(i.d)(Object(n.b)(e=>({offer:h(e),nearby:b(e),reviews:E(e),isLoaded:f(e)}),J),H.a)($)}}]);
//# sourceMappingURL=3.bundle.js.map